import paho.mqtt.client as mqtt
import time

BROKER_HOST = "127.0.0.1"   # change if your broker is on another machine
BROKER_PORT = 2147
TOPIC = "cosmos/telemetry"

# Array of hex strings to be assessed for generating alerts
HEX_STRINGS = [
    "98 BA 76 00 a5 aa f0 2c 4f 7e 69 ec 04 00 00 81 00 04 6d 02 01 01 ff ff 88 0c 00 00 09 00 08 49 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 cb ea fa 05 16 00 01 00 00 00 00 01 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 08 00 2c 01 05 00 06 00 06 00 06 00 02 00 00 00 03 00 04 00 b5 00 00 00 02 00 04 00 02 00 0f 0d 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 0a 00 1d 1c 1b 1b 1b 1a 1a 1a 1c 1c 1b 1b 1a 1a 1a 1a 1d 1d 1b 1b 1a 1b 1a 1a 8d 01 00 34 06 00 00 02 00 00 00 02 00 3a 00 00 00 02 00 01 00 06 00 1f 00 03 00 00 00 02 00 00 00 03 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 00 00 02 00 02 00 21 00 00 00 09 00 36 00 00 00 01 00 01 00 02 00 00 00 03 00 01 00 00 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 49 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 cb ea fa 05 16 00 01 00 00 00 00 01 01 01 01 00 00 00 00 01 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 08 00 2c 01 05 00 07 00 06 00 06 00 00 00 00 00 02 00 04 00 b6 00 00 00 01 00 01 00 03 00 0f 0c 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 0d 00 1d 1c 1b 1b 1b 1a 1a 1a 1c 1c 1b 1b 1a 1b 1a 1a 1d 1d 1b 1b 1a 1b 1a 1a bd 01 00 f4 06 00 00 02 00 00 00 02 00 33 00 00 00 02 00 01 00 07 00 1e 00 02 00 00 00 02 00 01 00 03 00 00 00 02 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 00 00 02 00 03 00 20 00 00 00 09 00 32 00 01 00 02 00 00 00 01 00 00 00 05 00 01 00 01 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 03 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 73 4a 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 cb ea fa 05 16 00 01 00 00 00 00 01 01 01 01 00 00 00 00 01 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 08 00 2c 01 06 00 07 00 06 00 06 00 00 00 00 00 00 00 01 00 b8 00 00 00 02 00 02 00 03 00 0f 0c 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 03 00 1d 1d 1b 1b 1b 1a 1a 1a 1c 1c 1b 1b 1a 1b 1a 1a 1d 1e 1b 1b 1a 1b 1a 1a bd 01 00 f4 06 00 00 02 00 00 00 02 00 31 00 01 00 01 00 00 00 06 00 1e 00 03 00 00 00 02 00 00 00 02 00 00 00 00 00 01 00 01 00 00 00 01 00 00 00 03 00 00 00 00 00 01 00 02 00 21 00 00 00 09 00 3a 00 02 00 01 00 02 00 02 00 00 00 03 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 31 4b 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 cb ea fa 05 16 00 01 00 00 00 00 01 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 08 00 2c 01 06 00 07 00 06 00 06 00 02 00 00 00 01 00 03 00 b5 00 00 00 02 00 00 00 03 00 0f 0c 10 10 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 0a 00 1d 1d 1b 1b 1b 1a 1a 1a 1c 1c 1b 1b 1a 1b 1a 1b 1d 1e 1b 1b 1a 1b 1a 1a 8d 01 00 34 06 00 00 02 00 00 00 03 00 36 00 00 00 01 00 01 00 07 00 1d 00 02 00 00 00 03 00 00 00 04 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 00 00 02 00 02 00 21 00 00 00 09 00 36 00 02 00 00 00 01 00 03 00 00 00 04 00 01 00 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e1 4b 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 cb ea fa 05 16 00 01 00 00 00 00 01 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 08 00 2c 01 06 00 07 00 06 00 06 00 00 00 00 00 02 00 04 00 b6 00 00 00 01 00 00 00 00 00 10 0d 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 06 00 1e 1d 1c 1b 1b 1a 1b 1a 1d 1c 1b 1b 1b 1b 1a 1b 1d 1e 1b 1b 1a 1b 1a 1a 8d 01 00 34 06 00 00 02 00 00 00 02 00 34 00 00 00 01 00 00 00 06 00 1e 00 03 00 00 00 03 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 01 00 20 00 01 00 09 00 3a 00 01 00 00 00 01 00 02 00 00 00 04 00 01 00 01 00 00 00 01 00 00 00 01 00 00 00 03 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 91 4c 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 ab ea fa 05 16 00 01 00 00 00 01 00 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 09 00 2c 01 06 00 07 00 06 00 07 00 00 00 01 00 02 00 03 00 b6 00 00 00 00 00 02 00 03 00 0f 0d 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 0a 00 1e 1d 1c 1b 1b 1a 1b 1a 1d 1d 1b 1b 1b 1b 1a 1b 1d 1e 1b 1c 1a 1b 1a 1b 8d 01 00 34 06 00 00 02 00 00 00 03 00 36 00 01 00 02 00 01 00 06 00 1d 00 03 00 00 00 03 00 02 00 02 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 03 00 00 00 00 00 01 00 02 00 20 00 00 00 09 00 34 00 02 00 00 00 01 00 02 00 00 00 03 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 00 00 01 00 02 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c 4d 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 ab ea fa 05 16 00 01 00 00 00 01 00 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 07 00 06 00 09 00 2c 01 06 00 07 00 06 00 07 00 01 00 02 00 00 00 03 00 b5 00 00 00 00 00 02 00 01 00 0f 0d 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 03 00 1e 1d 1c 1b 1b 1a 1b 1a 1d 1d 1b 1b 1b 1b 1a 1b 1d 1e 1b 1c 1a 1b 1b 1b 8d 01 00 34 06 00 00 02 00 00 00 02 00 34 00 01 00 01 00 00 00 05 00 1e 00 04 00 00 00 02 00 01 00 02 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 00 00 00 00 01 00 1e 00 00 00 09 00 3a 00 02 00 00 00 02 00 02 00 00 00 04 00 01 00 01 00 00 00 01 00 01 00 00 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fc 4d 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 ab ea fa 05 16 00 01 00 00 00 01 00 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 08 00 07 00 09 00 2c 01 06 00 07 00 07 00 07 00 00 00 00 00 00 00 00 00 b7 00 00 00 02 00 00 00 04 00 10 0d 11 11 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 0a 00 1e 1d 1c 1b 1b 1a 1b 1a 1d 1d 1b 1b 1b 1b 1a 1b 1d 1e 1b 1c 1a 1b 1b 1b 8d 01 00 34 06 00 00 01 00 00 00 01 00 36 00 01 00 01 00 01 00 07 00 1e 00 04 00 00 00 03 00 01 00 01 00 00 00 02 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 00 00 00 00 00 00 1e 00 00 00 09 00 34 00 01 00 00 00 02 00 02 00 00 00 03 00 01 00 01 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b6 4e 7e 69 00 00 00 00 5a 1f 74 97 5a 1f 00 00 74 97 01 00 ab ea fa 05 16 00 01 00 00 00 01 00 01 01 01 00 00 00 00 00 00 00 00 00 01 00 01 31 01 d7 00 09 05 09 05 00 18 34 34 00 00 00 00 02 00 00 00 05 00 08 00 07 00 09 00 2c 01 07 00 07 00 07 00 07 00 00 00 00 00 02 00 03 00 b7 00 00 00 02 00 02 00 05 00 10 0d 12 12 11 7a 00 79 00 7a 00 1c 01 3f 01 42 01 f6 ff 1e 1d 1c 1b 1b 1a 1b 1a 1d 1d 1b 1c 1b 1b 1a 1b 1d 1e 1b 1c 1b 1b 1b 1b 8d 01 00 34 06 00 00 01 00 00 00 03 00 36 00 00 00 00 00 01 00 07 00 1e 00 03 00 00 00 01 00 00 00 03 00 00 00 03 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 20 00 00 00 09 00 36 00 02 00 00 00 02 00 02 00 00 00 03 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 84 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a7 3f de 6c b0 76 f8 5c 73 5e bb 81 17 2b 60 5f 5a 01 15 5f 80 0d 8a 8a 9b 72 08 02 e7 1e 71 a8 c5 ba"
]

def main():
    client = mqtt.Client(client_id="cosmos_telemetry_test_publisher")
    client.connect(BROKER_HOST, BROKER_PORT, keepalive=60)
    
    for i, hex_str in enumerate(HEX_STRINGS):
        try:
            # Convert hex string to raw bytes
            payload = bytes.fromhex(hex_str)
            
            # Publish and make sure itâ€™s sent
            result = client.publish(TOPIC, payload)
            result.wait_for_publish()
            
            print(f"[{i+1}/{len(HEX_STRINGS)}] Published {len(payload)} bytes to '{TOPIC}'")
            
            # Small delay between publishes if needed
            time.sleep(0.5) 
            
        except ValueError as e:
            print(f"Error parsing hex string at index {i}: {e}")

    client.disconnect()
    print(f"\nFinished publishing all {len(HEX_STRINGS)} messages to {BROKER_HOST}:{BROKER_PORT}")

if __name__ == "__main__":
    main()